
{{#docs}}/// {{.}}
{{/docs}}
class {{name}} extends streamy.Request {
  static final List<String> KNOWN_PARAMETERS = [
{{#parameters}}    '{{name}}',
{{/parameters}}  ];

  String get apiType => '{{name}}';

  {{#payload}}{{payloadType}} get payload => streamy.internalGetPayload(this);{{/payload}}

  String get httpMethod => '{{httpMethod}}';

  String get pathFormat => '{{path}}';

  bool get hasPayload => {{#payload}}true{{/payload}}{{^payload}}false{{/payload}};

  {{name}}(streamy.Root root{{#payload}}, {{payloadType}} payloadEntity{{/payload}}) : super(root{{#payload}}, payloadEntity{{/payload}}) {
{{#parameters}}{{#repeated}}    {{varName}} = new {{type}}();
{{/repeated}}{{/parameters}}
  }

  List<String> get pathParameters => const [{{#path_parameters}}'{{name}}',{{/path_parameters}}];
  List<String> get queryParameters => const [{{#query_parameters}}'{{name}}',{{/query_parameters}}];

{{#parameters}}
{{#docs}}  /// {{.}}
{{/docs}}
  {{type}} get {{varName}} => parameters['{{name}}'];

  set {{varName}}({{type}} value) {
    parameters['{{name}}'] = value;
  }
  {{type}} remove{{capVarName}}() => parameters.remove('{{name}}');
{{/parameters}}

  Stream<streamy.Response{{#hasResponse}}<{{responseType}}>{{/hasResponse}}> _sendDirect() => this.root.send(this);


  {{^hasSendParams}}Stream<streamy.Response{{#hasResponse}}<{{responseType}}>{{/hasResponse}}> sendRaw() =>
      _sendDirect();{{/hasSendParams}}
  {{#hasSendParams}}Stream<streamy.Response{{#hasResponse}}<{{responseType}}>{{/hasResponse}}> sendRaw({
{{#sendParams}}      {{type}} {{name}}: {{default}}{{^last}},{{/last}}{{#last}} }) { {{/last}}
{{/sendParams}}
{{#sendParams}}
    this.local['{{name}}'] = {{name}};
{{/sendParams}}
    return _sendDirect();
  }
  {{/hasSendParams}}

  {{^hasSendParams}}Stream{{#hasResponse}}<{{responseType}}>{{/hasResponse}} send() =>
      _sendDirect().map((response) => response.entity);{{/hasSendParams}}

  {{#hasSendParams}}Stream{{#hasResponse}}<{{responseType}}>{{/hasResponse}} send({
{{#sendParams}}      {{type}} {{name}}: {{default}}{{^last}},{{/last}}{{#last}} }) { {{/last}}
{{/sendParams}}
{{#sendParams}}
    this.local['{{name}}'] = {{name}};
{{/sendParams}}
    return _sendDirect().map((response) => response.entity);
  }{{/hasSendParams}}

  {{^hasSendParams}}StreamSubscription{{#hasResponse}}<{{responseType}}>{{/hasResponse}} listen(void onData({{#hasResponse}}{{responseType}} {{/hasResponse}}event)) =>
      _sendDirect().map((response) => response.entity).listen(onData);{{/hasSendParams}}
  {{#hasSendParams}}StreamSubscription{{#hasResponse}}<{{responseType}}>{{/hasResponse}} listen(void onData({{#hasResponse}}{{responseType}} {{/hasResponse}}event), {
{{#sendParams}}      {{type}} {{name}}: {{default}}{{^last}},{{/last}}{{#last}} }) { {{/last}}
{{/sendParams}}
{{#sendParams}}
    this.local['{{name}}'] = {{name}};
{{/sendParams}}
    return _sendDirect().map((response) => response.entity).listen(onData);
  }{{/hasSendParams}}

  {{name}} clone() => streamy.internalCloneFrom(new {{name}}(root{{#payload}}, payload.clone(){{/payload}}), this);

{{#hasResponse}}
  streamy.Deserializer get responseDeserializer => (String str, streamy.Trace trace) =>
      new {{responseType}}.fromJsonString(str, trace, typeRegistry: root.typeRegistry);
{{/hasResponse}}
{{^hasResponse}}
  streamy.Deserializer get responseDeserializer => (String str, streamy.Trace trace) =>
      new streamy.EmptyEntity();
{{/hasResponse}}
}
